!function(n){const i={container:"",init(){const a=this;a.container=n("#outpaceseo-schema-settings, #outpaceseo-custom-fields"),n(document).ready(function(){n(".select2-class").select2();var t=["Site Meta","Post Meta (Basic Fields)"];if("custom-markup"===n("#outpaceseo-schema-type").val())for(let e=0;e<t.length;e++)n('#outpaceseo-custom-markup-custom-markup optgroup[label="'+t[e]+'"]').remove();var a=n("#custom-schema-schema-field").val();if(a)for(let e=0;e<t.length;e++)n("#custom-markup-"+a+'-custom-markup-connected optgroup[label="'+t[e]+'"]').remove()}),a.container.on("change","select.outpaceseo-schema-meta-field",function(){const e=n(this),t=e.parent(),a=e.val(),s=t.find(".outpaceseo-schema-custom-text-wrap"),o=("custom-text"===a?s.removeClass("op-hidden"):s.hasClass("op-hidden")||s.addClass("op-hidden"),t.find(".outpaceseo-schema-fixed-text-wrap")),i=("fixed-text"===a?o.removeClass("op-hidden"):o.hasClass("op-hidden")||o.addClass("op-hidden"),t.find(".outpaceseo-schema-specific-field-wrap"));"specific-field"===a?i.removeClass("op-hidden"):i.hasClass("op-hidden")||i.addClass("op-hidden")}),a.container.on("change",".outpaceseo-schema-row-rating-type select.outpaceseo-schema-meta-field",function(e){if(e.preventDefault(),n(this).closest(".outpaceseo-schema-table").find(".outpaceseo-schema-row").css("display",""),"accept-user-rating"===n(this).val()){const t=n(this).closest(".outpaceseo-schema-row").next(".outpaceseo-schema-row"),a=t.find(".outpaceseo-schema-meta-field").attr("name");e=jQuery(".outpaceseo-review-schema-type").val();e&&0<=a.indexOf("outpaceseo-review["+e+"-review-count]")&&t.hide(),0<=a.indexOf("[review-count]")&&t.hide()}}),a.container.find("select.outpaceseo-schema-meta-field").trigger("change"),n("select.outpaceseo-schema-select2").each(function(e,t){a.init_target_rule_select2(t)}),a.container.on("click",".op-repeater-add-new-btn",function(e){e.preventDefault(),a.add_new_repeater(n(this)),a.prepare_event_schmea_fields()}),a.container.on("click",".op-repeater-close",function(e){e.preventDefault(),a.add_remove_repeater(n(this))}),a.schemaTypeDependency(),a.bindTooltip(),n("body").hasClass("post-type-outpace_schema")||a.field_validation()},field_validation(){n(".outpaceseo-schema-meta-field, image-field-wrap, .outpaceseo-custom-field, .wpsp-custom-field-connect").on("click focus change",function(){n(".outpaceseo-schema-type-wrap").each(function(e,t){let a=n(t).find(".op-default-hidden-value").val();const s=n(t).parents(".outpaceseo-schema-row-content").prev();if(undefined!==a)if(a=a.trim())if(n("body").hasClass("block-editor-page"))if(n(t).find(".op-required-error-field").length)s.removeClass("op-required-error-field"),s.find("label").removeClass("op-required-error-field");else{let e;switch(a){case"post_title":e=n(".editor-post-title__input").val();break;case"post_content":e=1<n("p.block-editor-rich-text__editable").text().length?n("p.block-editor-rich-text__editable").text():"";break;case"post_excerpt":e=n(".components-textarea-control__input").val();break;case"featured_img":e="Set featured image"===n(".editor-post-featured-image__toggle").text()?"":n(".components-responsive-wrapper__content").attr("src");break;default:s.removeClass("op-required-error-field"),s.find("label").removeClass("op-required-error-field")}undefined!==e&&(""!==e?(s.removeClass("op-required-error-field"),s.find("label").removeClass("op-required-error-field")):s.find(".required").length&&s.find("label").addClass("op-required-error-field"))}else s.removeClass("op-required-error-field"),s.find("label").removeClass("op-required-error-field");else s.find(".required").length&&s.find("label").addClass("op-required-error-field")})})},hide_review_count(){if(n(this).closest(".outpaceseo-schema-table").find(".outpaceseo-schema-row").css("display",""),"accept-user-rating"===n(this).val()){const t=n(this).closest(".outpaceseo-schema-row").next(".outpaceseo-schema-row"),a=t.find(".outpaceseo-schema-meta-field").attr("name");var e=jQuery(".outpaceseo-review-schema-type").val();e&&0<=a.indexOf("outpaceseo-review["+e+"-review-count]")&&t.hide(),0<=a.indexOf("[review-count]")&&t.hide()}},add_new_repeater(e){const a=this,t=e.closest(".outpaceseo-schema-type-wrap"),s=t.find(".outpaceseo-repeater-table-wrap").length,o=t.find(".outpaceseo-repeater-table-wrap").first().clone();o.find(".outpaceseo-schema-custom-text-wrap, .outpaceseo-schema-specific-field-wrap").each(function(){n(this).hasClass("op-hidden")||n(this).addClass("op-hidden")}),o.find("select.outpaceseo-schema-meta-field").each(function(){n(this).val("none");var e=void 0!==n(this).attr("name")?n(this).attr("name").replace("[0]","["+s+"]"):"",t=void 0!==n(this).attr("class")?n(this).attr("class").replace("-0-","-"+s+"-"):"",a=void 0!==n(this).attr("id")?n(this).attr("id").replace("-0-","-"+s+"-"):"";n(this).attr("name",e),n(this).attr("class",t),n(this).attr("id",a)}),o.find("input, textarea, select:not(.outpaceseo-schema-meta-field)").each(function(){n(this).val("");var e=void 0!==n(this).attr("name")?n(this).attr("name").replace("[0]","["+s+"]"):"",t=void 0!==n(this).attr("class")?n(this).attr("class").replace("-0-","-"+s+"-"):"",a=void 0!==n(this).attr("id")?n(this).attr("id").replace("-0-","-"+s+"-"):"";n(this).attr("name",e),n(this).attr("class",t),n(this).attr("id",a)}),o.find("span.select2-container").each(function(){n(this).remove()}),o.insertBefore(e),o.find("select.outpaceseo-schema-select2").each(function(e,t){a.init_target_rule_select2(t)}),i.init_date_time_fields()},add_remove_repeater(e){const t=e.closest(".outpaceseo-schema-type-wrap"),a=t.find("> .outpaceseo-repeater-table-wrap").length;1<a&&(e.closest(".outpaceseo-repeater-table-wrap").remove(),"outpaceseo-custom-fields"===this.container.attr("id")&&t.find("> .outpaceseo-repeater-table-wrap").each(function(s,e){n(e).each(function(e,t){n(t).find("input, textarea, select:not(.outpaceseo-schema-meta-field)").each(function(e,t){var a=void 0!==n(t).attr("name")?n(t).attr("name").replace(/\[\d+]/,"["+s+"]"):"";n(t).attr("name",a)})})}))},bindTooltip(){n(".outpaceseo-schema-heading-help").tooltip({content(){return n(this).prop("title")},tooltipClass:"outpaceseo-schema-ui-tooltip",position:{my:"center top",at:"center bottom+10"},hide:{duration:200},show:{duration:200}})},schemaTypeDependency(){const t=this.container;this.container.on("change",'select[name="outpaceseo-schema-type"]',function(){t.find(".outpaceseo-schema-meta-wrap").css("display","none");var e=n(this).val();void 0!==e&&""!==e&&t.find("#op-"+e+"-schema-meta-wrap").css("display","")})},init_target_rule_select2(e){n(e).select2({placeholder:"Search Fields...",ajax:{url:ajaxurl,dataType:"json",method:"post",delay:250,data(e){return{nonce_ajax:AIOSRS_Rating.specified_field,q:e.term,page:e.page,action:"op_get_specific_meta_fields"}},processResults(e){return{results:e}},cache:!0},minimumInputLength:2})},get_review_item_type_html(t){jQuery.post({url:ajaxurl,data:{action:"fetch_item_type_html",itemType:t,nonce:AIOSRS_Rating.security,post_id:jQuery("#post_ID").val()}}).done(function(e){n(".op-review-item-type-field").remove(),n(e).insertAfter(jQuery("#outpaceseo-review-schema-type").parent().parent().closest("tr")),n("select.outpaceseo-schema-select2").each(function(e,t){i.init_target_rule_select2(t)}),n(".outpaceseo-review-"+t+"-rating").each(function(){if(n(this).closest(".outpaceseo-schema-table").find(".outpaceseo-schema-row").css("display",""),"accept-user-rating"===n(this).val()){const t=n(this).closest(".outpaceseo-schema-row").next(".outpaceseo-schema-row"),a=t.find(".outpaceseo-schema-meta-field").attr("name");var e=jQuery(".outpaceseo-review-schema-type").val();e&&0<=a.indexOf("outpaceseo-review["+e+"-review-count]")&&t.hide(),0<=a.indexOf("[review-count]")&&t.hide()}}),i.init_date_time_fields(),i.prepare_event_schmea_fields()}).fail(function(){})},prepare_event_schmea_fields(){n(".wpsp-dropdown-event-status, .wpsp-dropdown-outpaceseo-event-event-status").change(function(){const e=n(this).parents(".outpaceseo-schema-meta-wrap, .outpaceseo-meta-fields-wrap");e.find("td.wpsp-event-status-rescheduled, td.outpaceseo-review-outpaceseo-event-previous-date").hide(),this.value||(this.value="EventScheduled"),"EventRescheduled"===this.value&&e.find("td.wpsp-event-status-rescheduled, td.outpaceseo-review-outpaceseo-event-previous-date").show();var t=n(".wpsp-dropdown-event-attendance-mode, .wpsp-dropdown-outpaceseo-event-event-attendance-mode").val();"EventMovedOnline"===this.value||"OfflineEventAttendanceMode"!==t?(e.find("td.wpsp-event-status-offline").hide(),e.find("td.wpsp-event-status-online").show(),e.find(".wpsp-dropdown-event-attendance-mode, .wpsp-dropdown-outpaceseo-event-event-attendance-mode").val("OnlineEventAttendanceMode")):(e.find("td.wpsp-event-status-offline").show(),e.find("td.wpsp-event-status-online").hide())}),n(".wpsp-dropdown-event-attendance-mode, .wpsp-dropdown-outpaceseo-event-event-attendance-mode").change(function(){const e=n(this).parents(".outpaceseo-schema-meta-wrap, .outpaceseo-meta-fields-wrap");e.find("td.wpsp-event-status-rescheduled").hide(),"EventMovedOnline"!==n(".wpsp-dropdown-event-status, .wpsp-dropdown-outpaceseo-event-event-status").val()&&(e.find("td.wpsp-event-status-offline").show(),e.find("td.wpsp-event-status-online").hide()),"OfflineEventAttendanceMode"!==this.value&&(e.find("td.wpsp-event-status-offline").hide(),e.find("td.wpsp-event-status-online").show()),"MixedEventAttendanceMode"===this.value&&(e.find("td.wpsp-event-status-offline").show(),e.find("td.wpsp-event-status-online").show())}),n(".wpsp-dropdown-event-attendance-mode, .wpsp-dropdown-outpaceseo-event-event-attendance-mode").trigger("change")},init_date_time_fields(){n(".wpsp-datetime-local-field, .wpsp-date-field, .wpsp-time-duration-field").each(function(){n(this).removeClass("hasDatepicker")});const a=".wpsp-date-published-date, .wpsp-datetime-local-event-start-date, .wpsp-date-start-date, .wpsp-datetime-local-start-date",s=".wpsp-date-modified-date, .wpsp-datetime-local-event-end-date, .wpsp-date-end-date, .wpsp-datetime-local-end-date";n(document).on("focus",".wpsp-time-duration-field",function(){n(this).timepicker({timeFormat:"HH:mm:ss",hourMin:0,hourMax:99,oneLine:!0,currentText:"Clear",onSelect(){{var t=this;const a=n(t).closest(".outpaceseo-custom-field-time-duration"),s=a.find(".time-duration-field");let e=n(t).val();e="PT"+(e=(e=e.replace(/:/,"H")).replace(/:/,"M"))+"S",s.val(e);const o=n(t).parents(".wpsp-local-fields");return void o.find(".wpsp-default-hidden-value").val(e)}}})}),n(document).on("focus",".wpsp-datetime-local-field, .wpsp-date-field",function(){n(this).datetimepicker({dateFormat:"yy-mm-dd",timeFormat:"hh:mm TT",changeMonth:!0,changeYear:!0,showOn:"focus",showButtonPanel:!0,closeText:"Done",currentText:"Clear",yearRange:"-100:+10",onClose(e,t){t="#"+t.id;jQuery(t).is(a)?n(s).datetimepicker("option","minDate",new Date(e)):jQuery(t).is(s)&&n(a).datetimepicker("option","maxDate",new Date(e)),jQuery(t).parents(".wpsp-local-fields").find(".wpsp-default-hidden-value").val(e)}})}),n.datepicker._gotoToday=function(e){n(e).datepicker("setDate","").datepicker("hide").blur()}}};n(function(){i.init(),n("body").hasClass("outpaceseo-setup")||i.init_date_time_fields()}),n(document).ready(function(){let e=n(".outpaceseo-meta-fields-wrap");e.each(function(e,t){let a=n(t).find(".wpsp-field-label"),s=a.text();"Image License"===s.trim()&&a.attr("style","width:6%")}),n("#outpaceseo-review-schema-type").change(function(){var e=n(this).val().trim();e?i.get_review_item_type_html(e):n(".op-review-item-type-field").remove()}),n("#outpaceseo-review-schema-type").change(),i.prepare_event_schmea_fields()})}(jQuery);