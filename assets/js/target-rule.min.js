!function(l){const c=function(e){l(e).select2({placeholder:"Search pages / post / archives",ajax:{url:ajaxurl,dataType:"json",method:"post",delay:250,data(e){return{q:e.term,page:e.page,action:"op_get_posts_by_query",nonce:Targetrule.security}},processResults(e){return{results:e}},cache:!0},minimumInputLength:2})},a=function(e){const t=e.find(".op-target_rule-input"),n=[];e.find(".op-target-rule-condition").each(function(){const e=l(this);const t=e.find("select.target_rule-condition"),r=e.find("select.target_rule-specific-page");var a=t.val(),o=r.val();""!==a&&(a={type:a,specific:o},n.push(a))});e=JSON.stringify(n);t.val(e)},u=function(e){var t=e.closest(".op-target-rule-wrapper").attr("data-type");const r=e.find(".op-target-rule-condition");let a=!1;("display"!==t||1<r.length)&&(a=!0),r.each(function(){a?jQuery(this).find(".target_rule-condition-delete").removeClass("op-hidden"):jQuery(this).find(".target_rule-condition-delete").addClass("op-hidden")})},o=function(e,t){const r=l(".op-target-rule-display-on-wrap"),a=l(".op-target-rule-exclude-on-wrap"),o=a.closest("tr"),n=r.find(".target_rule-add-exclusion-rule");var i=a.find(".op-target-rule-condition");!0===t||!0!==e&&1===i.length&&""===l(i[0]).find("select.target_rule-condition").val()?(o.addClass("op-hidden"),n.removeClass("op-hidden")):(o.removeClass("op-hidden"),n.addClass("op-hidden"))};l(document).ready(function(){jQuery(".op-target-rule-condition").each(function(){const e=l(this),t=e.find("select.target_rule-condition"),r=t.val(),a=e.next(".target_rule-specific-page-wrap");"specifics"===r&&a.slideDown(300)}),jQuery(".op-target-rule-selector-wrapper select.target-rule-select2").each(function(e,t){c(t)}),jQuery(".op-target-rule-selector-wrapper").each(function(){u(jQuery(this))}),jQuery(document).on("change",".op-target-rule-condition select.target_rule-condition",function(){const e=jQuery(this),t=e.val(),r=e.closest(".op-target-rule-wrapper");"specifics"===t?e.closest(".op-target-rule-condition").next(".target_rule-specific-page-wrap").slideDown(300):e.closest(".op-target-rule-condition").next(".target_rule-specific-page-wrap").slideUp(300),a(r)}),jQuery(".op-target-rule-selector-wrapper").on("change",".target-rule-select2",function(){const e=jQuery(this),t=e.closest(".op-target-rule-wrapper");a(t)}),jQuery(".op-target-rule-selector-wrapper").on("click",".target_rule-add-rule-wrap a",function(e){e.preventDefault(),e.stopPropagation();const t=jQuery(this),r=t.attr("data-rule-id"),a=parseInt(r)+1,o=t.attr("data-rule-type"),n=t.closest(".op-target-rule-selector-wrapper").find(".target_rule-builder-wrap"),i=wp.template("op-target-rule-"+o+"-condition"),l=t.closest(".op-target-rule-wrapper");n.append(i({id:a,type:o})),c(".op-target-rule-"+o+"-on .target-rule-select2"),t.attr("data-rule-id",a),u(l)}),jQuery(".op-target-rule-selector-wrapper").on("click",".target_rule-condition-delete",function(){const e=jQuery(this),t=e.closest(".op-target-rule-condition"),r=e.closest(".op-target-rule-wrapper");let n=0;"exclude"===r.attr("data-type")&&1===r.find(".op-target-rule-condition").length?(r.find(".target_rule-condition").val(""),r.find(".target_rule-specific-page").val(""),r.find(".target_rule-condition").trigger("change"),o(!1,!0)):(e.parent(".op-target-rule-condition").next(".target_rule-specific-page-wrap").remove(),t.remove()),r.find(".op-target-rule-condition").each(function(e){const t=jQuery(this),r=t.attr("data-rule"),a=t.find(".target_rule-condition"),o=a.attr("name");t.attr("data-rule",e),a.attr("name",o.replace("["+r+"]","["+e+"]")),t.removeClass("op-target-rule-"+r).addClass("op-target-rule-"+e),n=e}),r.find(".target_rule-add-rule-wrap a").attr("data-rule-id",n),u(r),a(r)}),jQuery(".op-target-rule-selector-wrapper").on("click",".target_rule-add-exclusion-rule a",function(e){e.preventDefault(),e.stopPropagation(),o(!0)})})}(jQuery);